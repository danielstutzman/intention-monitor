:javascript
  var ESC_KEY_CODE   = 27;
  var F1_KEY_CODE    = 112;
  var F2_KEY_CODE    = 113;
  var F3_KEY_CODE    = 114;
  var F4_KEY_CODE    = 115;
  var SPACE_KEY_CODE = 32;
  var MILLIS_TO_LOSE_FOCUS = 60 * 1000;

  function setSleep(newSleep) {
    var url = (newSleep) ? '/sleep/on' : '/sleep/off';
    var xhr = new XMLHttpRequest();
    xhr.open('POST', url, true);
    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    xhr.send(null); // no data
  }

  var IntentionSection = require('./app/IntentionSection.coffee');
  var  ScheduleSection = require('./app/ScheduleSection.coffee');
  var     AlertSection = require('./app/AlertSection.coffee');
  var   BedtimeSection = require('./app/BedtimeSection.coffee');
  document.addEventListener('DOMContentLoaded', function() {
    var alertSection =
      new AlertSection(document.getElementById('alert'));
    var intentionSection =
      new IntentionSection(document.getElementById('intention'), alertSection);
    var scheduleSection =
      new ScheduleSection(document.getElementById('schedule'));
    var bedtimeSection =
      new BedtimeSection(document.getElementById('bedtime'));

    window.addEventListener('keydown', function(e) {
      if (e.keyCode == F1_KEY_CODE) {
        setSleep(true);
        e.preventDefault();
      } else if (e.keyCode == F2_KEY_CODE) {
        document.getElementById('intention').style.display = 'block';
        document.getElementById('schedule').style.display = 'none';
        document.getElementById('bedtime').style.display = 'none';
        intentionSection.focus();
        e.preventDefault();
      } else if (e.keyCode == F3_KEY_CODE) {
        document.getElementById('intention').style.display = 'none';
        document.getElementById('schedule').style.display = 'block';
        document.getElementById('bedtime').style.display = 'none';
        scheduleSection.focus();
        e.preventDefault();
      } else if (e.keyCode == F4_KEY_CODE) {
        document.getElementById('intention').style.display = 'none';
        document.getElementById('schedule').style.display = 'none';
        document.getElementById('bedtime').style.display = 'block';
        bedtimeSection.focus();
        e.preventDefault();
      }
    });

    document.getElementById('keyCapture').addEventListener(
        'keydown', function(e) {
      if (e.keyCode == SPACE_KEY_CODE) {
        document.getElementById('intention').style.display = 'block';
        document.getElementById('schedule').style.display = 'none';
        intentionSection.togglePause();
        e.preventDefault();
      }
    });

    var aWhileSinceInputTimeout = null;
    var aWhileSinceInput = function() {
      document.getElementById('keyCapture').focus();
    };
    window.addEventListener('keydown', function(e) {
      window.clearTimeout(aWhileSinceInputTimeout);
      aWhileSinceInputTimeout = window.setTimeout(aWhileSinceInput,
        MILLIS_TO_LOSE_FOCUS);

      if (e.keyCode == ESC_KEY_CODE) {
        document.getElementById('keyCapture').focus();
        e.preventDefault();
      }
    });
    window.addEventListener('click', function(e) {
      window.clearTimeout(aWhileSinceInputTimeout);
      aWhileSinceInputTimeout = window.setTimeout(aWhileSinceInput,
        MILLIS_TO_LOSE_FOCUS);
    });

    intentionSection.run();
    scheduleSection.run();
    alertSection.run();
    bedtimeSection.run();
    document.getElementById('keyCapture').focus();

    var stream = new EventSource('/stream');
    stream.onmessage = function(e) {
      if (e.data === 'noticed-browsing') {
        if (!intentionSection.isWithinEstimate()) {
          setSleep(false); // turn on screen if it's off
          alertSection.addAlert('if browsing, stand or schedule; store after');
        }
      }
    };
  }, false);

#intention
#schedule(style='display:none')
#bedtime(style='display:none')
#alert
%input#keyCapture(type='text' style='background-color:black; border:0;')
